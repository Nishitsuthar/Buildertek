<aura:component controller="OrderPOFromProjectController" implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickActionWithoutHeader" access="global" >
    <aura:attribute name="masterBudgetsList" type="object" />
    <aura:attribute name="Spinner" type="Boolean" />
    <aura:attribute name="Spinner2" type="Boolean" />
    <aura:attribute name="showMessage" type="Boolean" default="false" />
    <aura:attribute name="selectedobjInfo" type="list"   /> 
    <!-- Attribute Declration For Pagination --> 
    <aura:attribute name="PaginationList" type="Object"/>
    <aura:attribute name="startPage" type="Integer" />
    <aura:attribute name="endPage" type="Integer"/>
    <aura:attribute name="totalRecords" type="Integer"/>
    <aura:attribute name="pageSize" type="Integer" default="25"/>
    <!-- Attribute Declration For Pagination End-->
    <!-- Attribute Declration For Search Functionality-->
    <aura:attribute name="searchResult" type="List"/>
    <aura:attribute name="searchKeyword" type="String" />
    <aura:attribute name="searchResult1" type="List" />
    <aura:attribute name="searchKeyword1" type="String" />
    <aura:attribute name="searchResult2" type="List" />
    <aura:attribute name="searchKeyword2" type="String" />
    <aura:attribute name="searchKeyword3" type="String" />
        <aura:attribute name="searchKeyword4" type="String" />

    
    <!-- Attribute Declration For Search Functionality-->
    
    <aura:attribute name="selectedPOList" type = "Boolean" default = "false"/>
    <aura:attribute name="SelectedPurchaseOrders" type="List" />
    
    <!--  Attributes for Header Details   -->
    <aura:attribute name="totalPOs" type="Integer" default="0"/>
    <aura:attribute name="totalPOAmount" type="decimal" default="0"/>
    <aura:attribute name="totalPaidAmount" type="decimal" default="0"/>
    <aura:attribute name="totalRemainingAmount" type="decimal" default="0"/>
    <aura:attribute name="orderedPercent" type="decimal" default="0"/>
    <aura:attribute name="paidPercent" type="decimal" default="0"/>
    <!--  Attributes for Header Details   -->
    
    <!--   Attributes to attach documents  Start   -->
    
    <aura:attribute name="fileData2" type="List" access="global"/>
    <aura:attribute name="fileName2" type="String" access="global"/>
    <aura:attribute name="FileLabelList" type="List" default="[]"/>
    <aura:attribute name="FileNameList" type="List" />
    <aura:attribute name="fileBody" type="string" access="global"/>
    
    <!--   Attributes to attach documents  End   -->
    
    
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" /> 
    <ltng:require styles="{!$Resource.MOdalPreviewWidth72}"/> 
    
    
    <div style = "position : sticky; top:5.6rem; background : white; z-index : 111">
        <div class="slds-modal__header" style="font-size:17px;">
            <div class="slds-p-around_xx-small">
                <lightning:layout multipleRows="true" class="leftClass">
                    
                    <lightning:layoutItem size="4">
                        <table>
                            <tbody>
                                <tr>
                                    <td style="text-align:right;width:7rem;"><b>Total POâ€™s</b></td>
                                    <td>:</td>
                                    <td><lightning:formattedNumber value="{!v.totalPOs}" /></td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;width:7rem;"><b>Ordered %</b></td>
                                    <td>:</td>
                                    <td><lightning:formattedNumber type="number" value="{!v.orderedPercent}"  variant="label-hidden" formatter="percent" step="0.01"/> %</td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;width:7rem;"><b>Paid % </b></td>
                                    <td>:</td>
                                    <td><lightning:formattedNumber type="number" value="{!v.paidPercent}" variant="label-hidden"  formatter="percent" step="0.01"/> %</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        
                        
                    </lightning:layoutItem>
                    
                    <lightning:layoutItem size="4">
                    </lightning:layoutItem>
                    
                    
                    
                    <lightning:layoutItem size="4" class="rightClass">
                        
                        <table>
                            <tbody>
                                <tr>
                                    <td style="text-align:right;"><b>Total PO Amount</b></td>
                                    <td>:&nbsp;&nbsp;</td>
                                    <td><lightning:formattedNumber value="{!v.totalPOAmount}" currencyCode="USD" style="currency" currencyDisplayAs="code"/></td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;"><b>Total Paid Amount</b></td>
                                    <td>:&nbsp;&nbsp;</td>
                                    <td><lightning:formattedNumber value="{!v.totalPaidAmount}" currencyCode="USD" style="currency" currencyDisplayAs="code"/></td>
                                </tr>
                                <tr>
                                    <td style="text-align:right;"><b>Total Remaining Amount </b></td>
                                    <td>:&nbsp;&nbsp;</td>
                                    <td><lightning:formattedNumber value="{!v.totalRemainingAmount}" currencyCode="USD" style="currency" currencyDisplayAs="code"/></td>
                                </tr>
                            </tbody>
                        </table>
                        
                        
                        
                    </lightning:layoutItem>
                    
                </lightning:layout>
                
            </div>
            
        </div>
        
        <lightning:layout multipleRows="true">
            
            <lightning:layoutItem padding="around-small" size="2.5">
                <lightning:input value="{!v.searchKeyword3}"
                                 placeholder="PO #"
                                 aura:id="searchKey3"
                                 name="searchField"
                                 class="pointer"
                                 text = "hai"
                                 type  = "search"
                                 autocomplete="false"
                                 onchange="{! c.searchKeyChange3}"/>
            </lightning:layoutItem>
            
            <lightning:layoutItem padding="around-small" size="2.5">
                <lightning:input value="{!v.searchKeyword4}"
                                 placeholder="Trade Type"
                                 aura:id="searchKey4"
                                 name="searchField"
                                 class="pointer"
                                 text = "hai"
                                 type  = "search"
                                 autocomplete="false"
                                 onchange="{! c.searchKeyChange4}"/>
            </lightning:layoutItem>
            
            <lightning:layoutItem padding="around-small" size="2.5">
                <!--  <div style = "width:21rem;">-->
                <lightning:input value="{!v.searchKeyword}"
                                 placeholder="Vendor"
                                 aura:id="searchKey"
                                 name="searchField"
                                 class="pointer"
                                 text = "hai"
                                 type  = "search"
                                 autocomplete="false"
                                 onchange="{! c.searchKeyChange }"/>
            </lightning:layoutItem>
            <lightning:layoutItem padding="around-small" size="2.5">
                <lightning:input value="{!v.searchKeyword1}"
                                 placeholder="Phase"
                                 aura:id="searchKey1"
                                 name="searchField"
                                 class="pointer"
                                 text = "hai"
                                 type  = "search"
                                 autocomplete="false"
                                 onchange="{! c.searchKeyChange1 }"/>
            </lightning:layoutItem>
            <lightning:layoutItem padding="around-small" size="3">
                <lightning:input value="{!v.searchKeyword2}"
                                 placeholder="Status"
                                 aura:id="searchKey2"
                                 name="searchField"
                                 class="pointer"
                                 text = "hai"
                                 type  = "search"
                                 autocomplete="false"
                                 onchange="{! c.searchKeyChange2 }"/>
            </lightning:layoutItem>
        </lightning:layout>
        
        <div style = "text-align:right;margin-right:8px;">
            <button class="slds-button slds-button--brand" onclick="{!c.orderPO}" disabled="{!v.isdisabled}"> Order</button>
            
        </div>
        
    </div>
    
    
    
    <div class="slds-modal__content slds-p-around_xx-small">
        <div class="slds slds-scope">
            <table class="slds-table slds-table_bordered slds-table_fixed-layout " role="grid">
                <thead>
                    <tr class="slds-text-title_caps">
                        <th scope="col" style="background-color:rgba(27, 82, 151, 1.0); color:white; border-top-left-radius:5px;vertical-align: top;line-height: 2;width: 30px !important;">
                            <ui:inputCheckbox aura:id="checkContractors"  change="{!c.selectAll}" />		
                        </th>
                        
                        <th  style="background-color:rgba(27, 82, 151, 1.0); color:white;vertical-align: top;line-height: 2;">
                            Phase
                        </th>
                        <th  style="background-color:rgba(27, 82, 151, 1.0); color:white;vertical-align: top;line-height: 2;">
                            PO #
                        </th>
                        <th  style="background-color:rgba(27, 82, 151, 1.0); color:white;vertical-align: top;line-height: 2;">
                            Description
                        </th>
                        <th  style="background-color:rgba(27, 82, 151, 1.0); color:white;vertical-align: top;line-height: 2;">
                            Status
                        </th>
                        <th  style="background-color:rgba(27, 82, 151, 1.0); color:white;vertical-align: top;line-height: 2;">
                            Vendor
                        </th>
                        
                        <th style="background-color:rgba(27, 82, 151, 1.0); color:white;vertical-align: top;line-height: 2;">
                            Change Order
                        </th>
                        <th  style="background-color:rgba(27, 82, 151, 1.0); color:white;vertical-align: top;line-height: 2;">
                            PO Balance
                        </th>
                        <th  style="background-color:rgba(27, 82, 151, 1.0); color:white;vertical-align: top;line-height: 2;">
                            Date Ordered
                        </th>
                        
                        <!--  <th  style="background-color:rgba(27, 82, 151, 1.0); color:white;vertical-align: top;line-height: 2;">
                            <span style="white-space: pre-wrap;">Primary Contact</span>
                        </th> 
                        <th  style="background-color:rgba(27, 82, 151, 1.0); color:white;vertical-align: top;line-height: 2;">
                            PO Total
                        </th>
                        <th  style="background-color:rgba(27, 82, 151, 1.0); color:white;vertical-align: top;line-height: 2;">
                            Paid Amount
                        </th> -->
                        
                        
                    </tr>
                </thead>
                <tbody class = "slds-scrollable">
                    
                    
                    
                    <aura:iteration items="{!v.PaginationList}" var="rec">
                        
                        <aura:if isTrue="{!rec.groupName != null}">
                            
                            
                            <tr class="groupHeader">
                                <td style = "background : #f3f3f3"></td>
                                <td title = "{!rec.groupName}" style = "background : #f3f3f3">
                                    <div class="slds-grid slds-gutters">
                                        <div class="slds-col slds-size_6-of-12"
                                             data-index='{!parentGroupIndex}'>
                                            <b>{!rec.groupName}  </b> 
                                        </div>
                                        <div class="slds-col slds-size_6-of-12 slds-float_right">
                                        </div>
                                    </div>
                                    <div class="slds-grid slds-gutters">
                                        <div class="slds-col slds-size_1-of-12 slds-is-sortable">
                                        </div>
                                    </div>
                                </td>
                                
                                <td style = "background : #f3f3f3">
                                </td>
                                <td style = "background : #f3f3f3">
                                </td>
                                <td style = "background : #f3f3f3">
                                </td>
                                <td style = "background : #f3f3f3">
                                </td>
                                <td style = "background : #f3f3f3">
                                </td>
                                <td style = "background : #f3f3f3">
                                </td>
                                <td style = "background : #f3f3f3">
                                </td>
                                
                                
                            </tr>
                            
                            
                            <aura:set attribute="else">
                                <tr class="groupHeader">
                                    <td style = "background : #f3f3f3"></td>
                                    <td title = "{!rec.groupName}" style = "background : #f3f3f3">
                                        <div class="slds-grid slds-gutters">
                                            <div class="slds-col slds-size_6-of-12"
                                                 data-index='{!parentGroupIndex}'>
                                                <b>  No Phase </b>
                                            </div>
                                            <div class="slds-col slds-size_6-of-12 slds-float_right">
                                            </div>
                                        </div>
                                        <div class="slds-grid slds-gutters">
                                            <div class="slds-col slds-size_1-of-12 slds-is-sortable">
                                            </div>
                                        </div>
                                    </td>
                                    <td style = "background : #f3f3f3">
                                    </td>
                                    <td style = "background : #f3f3f3">
                                    </td>
                                    <td style = "background : #f3f3f3">
                                    </td>
                                    <td style = "background : #f3f3f3">
                                    </td>
                                    <td style = "background : #f3f3f3">
                                    </td>
                                    <td style = "background : #f3f3f3">
                                    </td>
                                    
                                    <td style = "background : #f3f3f3">
                                    </td>
                                    
                                </tr>
                                
                            </aura:set>
                            
                        </aura:if>
                        
                        
                        
                        <aura:iteration items="{!rec.poRecordList}" var="record"> 
                            <tr class="slds-hint-parent">
                                <aura:if isTrue="{!record.Id != null}">
                                    <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}">
                                        <td style = "background : #d8e6f5"> 
                                        </td> 
                                        <aura:set attribute="else">
                                            
                                            <aura:if isTrue="{!or(record.buildertek__Status__c == 'Paid' , record.buildertek__Status__c == 'Partially Paid')}">
                                                <td style = "background : #d8e6f5"> 
                                                </td> 
                                                <aura:set attribute="else">
                                                    <td> 
                                                        <lightning:input aura:id="checkContractor" type="checkbox" checked="{record.poCheck}" name="{!record.Id}" onchange="{!c.handleCheck}"/>
                                                    </td> 
                                                </aura:set>
                                            </aura:if> 
                                            
                                            
                                        </aura:set>
                                    </aura:if>
                                    
                                    <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}">
                                        <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Phase__c}"  style = "background : #d8e6f5">
                                            <ui:outputText value="{!record.buildertek__Phase__c}" />  
                                        </td> 
                                        <aura:set attribute="else">
                                            
                                            
                                            <aura:if isTrue="{!or(record.buildertek__Status__c == 'Paid' , record.buildertek__Status__c == 'Partially Paid')}">
                                                <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Phase__c}"  style = "background : #d8e6f5">
                                                    <ui:outputText value="{!record.buildertek__Phase__c}" />  
                                                </td>  
                                                <aura:set attribute="else">
                                                    <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Phase__c}" >
                                                        <ui:outputText value="{!record.buildertek__Phase__c}" />  
                                                    </td> 
                                                </aura:set>
                                            </aura:if> 
                                            
                                            
                                            
                                        </aura:set>
                                    </aura:if>
                                    
                                    
                                    
                                    <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}">
                                        <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Phase__c}" style = "background : #d8e6f5">
                                            <ui:outputURL
                                                          value="{!'/one/one.app?#/sObject/'+ record.Id + '/view'}"
                                                          target="_blank" label="{!record.Name}" />
                                        </td>
                                        <aura:set attribute="else">
                                            
                                            <aura:if isTrue="{!or(record.buildertek__Status__c == 'Paid' , record.buildertek__Status__c == 'Partially Paid')}">
                                                <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Phase__c}" style = "background : #d8e6f5">
                                                    <ui:outputURL
                                                                  value="{!'/one/one.app?#/sObject/'+ record.Id + '/view'}"
                                                                  target="_blank" label="{!record.Name}" />
                                                </td>
                                                <aura:set attribute="else">
                                                    <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Phase__c}">
                                                        <ui:outputURL
                                                                      value="{!'/one/one.app?#/sObject/'+ record.Id + '/view'}"
                                                                      target="_blank" label="{!record.Name}" />
                                                    </td>
                                                </aura:set>
                                            </aura:if> 
                                            
                                        </aura:set>
                                    </aura:if>
                                    
                                    
                                    <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}">
                                        <td role="gridcell" title = "{!record.buildertek__Description__c}" class="slds-truncate" style = "background : #d8e6f5">
                                            <ui:outputText value="{!record.buildertek__Description__c}"  />  
                                        </td>
                                        <aura:set attribute="else">
                                            
                                            <aura:if isTrue="{!or(record.buildertek__Status__c == 'Paid' , record.buildertek__Status__c == 'Partially Paid')}">
                                                <td role="gridcell" title = "{!record.buildertek__Description__c}" class="slds-truncate" style = "background : #d8e6f5">
                                                    <ui:outputText value="{!record.buildertek__Description__c}"  />  
                                                </td>
                                                <aura:set attribute="else">
                                                    <td role="gridcell" title = "{!record.buildertek__Description__c}" class="slds-truncate">
                                                        <ui:outputText value="{!record.buildertek__Description__c}"  />  
                                                    </td>
                                                </aura:set>
                                            </aura:if> 
                                            
                                        </aura:set>
                                    </aura:if>
                                    
                                    
                                    <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}">
                                        <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Status__c}" style = "background : #d8e6f5">
                                            <ui:outputText value="{!record.buildertek__Status__c}" />  
                                        </td> 
                                        <aura:set attribute="else">
                                            
                                            
                                            <aura:if isTrue="{!or(record.buildertek__Status__c == 'Paid' , record.buildertek__Status__c == 'Partially Paid')}">
                                                <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Status__c}" style = "background : #d8e6f5">
                                                    <ui:outputText value="{!record.buildertek__Status__c}" />  
                                                </td> 
                                                <aura:set attribute="else">
                                                    <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Status__c}" >
                                                        <ui:outputText value="{!record.buildertek__Status__c}" />  
                                                    </td> 
                                                </aura:set>
                                            </aura:if> 
                                            
                                            
                                        </aura:set>
                                    </aura:if>
                                    
                                    
                                    
                                    
                                    <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}">
                                        <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Vendor__r.Name}" style = "background : #d8e6f5">
                                            <ui:outputURL
                                                          value="{!'/one/one.app?#/sObject/'+ record.buildertek__Vendor__c + '/view'}"
                                                          target="_blank" label="{!record.buildertek__Vendor__r.Name}" />
                                        </td>
                                        <aura:set attribute="else">
                                            
                                            
                                            <aura:if isTrue="{!or(record.buildertek__Status__c == 'Paid' , record.buildertek__Status__c == 'Partially Paid')}">
                                                <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Vendor__r.Name}" style = "background : #d8e6f5">
                                                    <ui:outputURL
                                                                  value="{!'/one/one.app?#/sObject/'+ record.buildertek__Vendor__c + '/view'}"
                                                                  target="_blank" label="{!record.buildertek__Vendor__r.Name}" />
                                                </td>
                                                <aura:set attribute="else">
                                                    <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Vendor__r.Name}">
                                                        <ui:outputURL
                                                                      value="{!'/one/one.app?#/sObject/'+ record.buildertek__Vendor__c + '/view'}"
                                                                      target="_blank" label="{!record.buildertek__Vendor__r.Name}" />
                                                    </td>
                                                </aura:set>
                                            </aura:if> 
                                            
                                            
                                        </aura:set>
                                    </aura:if>
                                    
                                    
                                    
                                    <!--   <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}">
                                        <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Vendor__r.Name}" style = "background : #d8e6f5">
                                            <ui:outputText value="{!record.buildertek__Vendor__r.Name}" />  
                                        </td> 
                                        <aura:set attribute="else">
                                            <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Vendor__r.Name}">
                                                <ui:outputText value="{!record.buildertek__Vendor__r.Name}" />  
                                            </td> 
                                        </aura:set>
                                    </aura:if>  -->
                                    
                                    
                                    <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}">
                                        <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Change_Order__r.Name}" style = "background : #d8e6f5">
                                            
                                            <ui:outputURL title = "{!record.buildertek__Change_Order__r.Name}"
                                                          value="{!'/one/one.app?#/sObject/'+ record.buildertek__Change_Order__c + '/view'}"
                                                          target="_blank" label="{!record.buildertek__Change_Order__r.Name}" />
                                        </td>
                                        <aura:set attribute="else">
                                            <aura:if isTrue="{!or(record.buildertek__Status__c == 'Paid' , record.buildertek__Status__c == 'Partially Paid')}">
                                                <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Change_Order__r.Name}" style = "background : #d8e6f5">
                                                    
                                                    <ui:outputURL title = "{!record.buildertek__Change_Order__r.Name}"
                                                                  value="{!'/one/one.app?#/sObject/'+ record.buildertek__Change_Order__c + '/view'}"
                                                                  target="_blank" label="{!record.buildertek__Change_Order__r.Name}" />
                                                </td>
                                                <aura:set attribute="else">
                                                    
                                                    <td role="gridcell" class="slds-truncate" >
                                                        <ui:outputURL title = "{!record.buildertek__Change_Order__r.Name}"
                                                                      value="{!'/one/one.app?#/sObject/'+ record.buildertek__Change_Order__c + '/view'}"
                                                                      target="_blank" label="{!record.buildertek__Change_Order__r.Name}" />
                                                    </td>
                                                </aura:set>
                                            </aura:if> 
                                        </aura:set>
                                    </aura:if>
                                    
                                    
                                    <!--      <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}">
                                        <td role="gridcell" title = "{!record.buildertek__PO_Total__c}" style = "background : #d8e6f5">
                                            <lightning:formattedNumber value="{!record.buildertek__PO_Total__c}" currencyCode="USD" style="currency" currencyDisplayAs="code"/>
                                        </td>
                                        <aura:set attribute="else">
                                            <td role="gridcell" title = "{!record.buildertek__PO_Total__c}">
                                                <lightning:formattedNumber value="{!record.buildertek__PO_Total__c}" currencyCode="USD" style="currency" currencyDisplayAs="code"/>
                                            </td>
                                        </aura:set>
                                    </aura:if>
                                    
                                    
                                   
                                    
                                     <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}">
                                        <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Vendor__r.Name}" style = "background : #d8e6f5">
                                                  <c:childOfOrderPOFromProject poId="{!record.buildertek__Vendor__c}" />                                     
                                          </td> 
                                        <aura:set attribute="else">
                                            <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Vendor__r.Name}">
                                                   <c:childOfOrderPOFromProject poId="{!record.buildertek__Vendor__c}" />
                                            </td> 
                                        </aura:set>
                                    </aura:if> 
                        
                                    <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}" >
                                        <td role="gridcell" title = "{!record.buildertek__Paid_Amount__c}" style = "background : #d8e6f5">
                                            <lightning:formattedNumber value="{!record.buildertek__Paid_Amount__c}" currencyCode="USD" style="currency" currencyDisplayAs="code"/>
                                        </td>
                                        <aura:set attribute="else">
                                            <td role="gridcell" title = "{!record.buildertek__Paid_Amount__c}">
                                                <lightning:formattedNumber value="{!record.buildertek__Paid_Amount__c}" currencyCode="USD" style="currency" currencyDisplayAs="code"/>
                                            </td>
                                        </aura:set>
                                    </aura:if>   -->
                                    
                                    
                                    <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}" >
                                        <td role="gridcell" title = "{!record.buildertek__PO_Balance__c}" style = "background : #d8e6f5">
                                            <lightning:formattedNumber value="{!record.buildertek__PO_Balance__c}" currencyCode="USD" style="currency" currencyDisplayAs="code"/>
                                        </td>
                                        <aura:set attribute="else">
                                            
                                            
                                            <aura:if isTrue="{!or(record.buildertek__Status__c == 'Paid' , record.buildertek__Status__c == 'Partially Paid')}">
                                                <td role="gridcell" title = "{!record.buildertek__PO_Balance__c}" style = "background : #d8e6f5">
                                                    <lightning:formattedNumber value="{!record.buildertek__PO_Balance__c}" currencyCode="USD" style="currency" currencyDisplayAs="code"/>
                                                </td>
                                                <aura:set attribute="else">
                                                    <td role="gridcell" title = "{!record.buildertek__PO_Balance__c}">
                                                        <lightning:formattedNumber value="{!record.buildertek__PO_Balance__c}" currencyCode="USD" style="currency" currencyDisplayAs="code"/>
                                                    </td>
                                                </aura:set>
                                            </aura:if> 
                                            
                                        </aura:set>
                                    </aura:if>
                                    
                                    
                                    
                                    <aura:if isTrue="{!record.buildertek__Status__c == 'Ordered'}">
                                        <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Date_Ordered__c}" style = "background : #d8e6f5">
                                            <ui:outputText value="{!record.buildertek__Date_Ordered__c}" />  
                                        </td> 
                                        <aura:set attribute="else">
                                            
                                            
                                            <aura:if isTrue="{!or(record.buildertek__Status__c == 'Paid' , record.buildertek__Status__c == 'Partially Paid')}">
                                                <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Date_Ordered__c}" style = "background : #d8e6f5">
                                                    <ui:outputText value="{!record.buildertek__Date_Ordered__c}" />  
                                                </td> 
                                                <aura:set attribute="else">
                                                    <td role="gridcell" class="slds-truncate" title = "{!record.buildertek__Date_Ordered__c}">
                                                        <ui:outputText value="{!record.buildertek__Date_Ordered__c}" />  
                                                    </td> 
                                                </aura:set>
                                            </aura:if> 
                                            
                                            
                                        </aura:set>
                                    </aura:if>
                                    
                                    
                                    <aura:set attribute="else">
                                        <div Style="text-align : center; font-size: 1.2rem;"> There is No Purchase order  </div>
                                    </aura:set>
                                </aura:if>
                            </tr> 
                            
                            
                        </aura:iteration>
                        
                    </aura:iteration>
                </tbody>
            </table>
            <br/>
        </div> 
        <aura:if isTrue="{!v.Spinner}">
            <div aura:id="spinnerId" class="slds-spinner_container">
                <div class="slds-spinner--brand  slds-spinner slds-spinner--large slds-is-relative" role="alert">
                    <span class="slds-assistive-text">Loading</span>
                    <div class="slds-spinner__dot-a"></div>
                    <div class="slds-spinner__dot-b"></div>
                    <div class="custom-loading-text">
                        <b>Processing, Please Wait</b>
                    </div>
                </div>
            </div>
        </aura:if>
    </div>
    <div class="slds-modal__footer">
        <lightning:button label="Previous" disabled="{!v.startPage == 0}"  
                          onclick="{!c.previous}" variant="brand"
                          iconName='utility:back' iconPosition='left' class = 'slds-float_left'/>
        &nbsp; &nbsp; &nbsp;
        <lightning:button label="Next" disabled="{!v.endPage >= v.totalRecords}" 
                          onclick="{!c.next}" variant="brand"
                          iconName='utility:forward' iconPosition='left' class = 'slds-float_left' />
        
        <button class="slds-button slds-button--brand" onclick="{!c.orderPO}" disabled="{!v.isdisabled}"> Order</button>
    </div>	
    
    
    
    
    <aura:if isTrue="{!v.selectedPOList}">
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                 aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container" style="min-width:30rem; ;max-width: 45%">
                
                <aura:html tag="style">
                    .cuf-content {
                    padding: 0 0rem !important;
                    }
                    .slds-p-around--medium {
                    padding: 0rem !important;
                    }       
                    .slds-modal__content{
                    overflow-y:hidden !important;
                    height:unset !important;
                    max-height:unset !important;
                    }
                </aura:html>
                
                <header class="slds-modal__header">
                    <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">
                        
                        <b>Are you sure you want to Order these Purchase Orders ? </b>
                    </h2>
                </header>
                
                <div class="slds-modal__content " id="modal-content-id-1" style = "margin-top:-9px; margin-bottom : -9px">
                    <div class="slds-card__body slds-scrollable left-screen" style="max-height:450px" >
                        <table class="slds-table slds-table--bordered">
                            <thead>
                            </thead>
                            
                            <tbody>
                                <tr>
                                    
                                    <th style="font-weight: 700;padding-left:15px">
                                        Phase
                                    </th>
                                    <th style="font-weight: 700;">PO #</th>
                                    <th style="font-weight: 700;">Description</th>
                                    <th style="font-weight: 700;">Vendor</th>
                                    <th style="font-weight: 700;">Email</th>
                                    
                                    <th style="font-weight: 700;">PO Total</th>
                                    <th></th>
                                </tr>
                                <aura:iteration items="{!v.SelectedPurchaseOrders}" var="row" indexVar="recIndex">
                                    <tr>
                                        
                                        
                                        <td>
                                            {!row.buildertek__Phase__c}
                                        </td>
                                        
                                        <td>
                                            <ui:outputURL
                                                          value="{!'/one/one.app?#/sObject/'+ row.Id + '/view'}"
                                                          target="_blank" label="{!row.Name}" />
                                        </td>
                                        
                                        
                                        <td>
                                            <ui:outputText value="{!row.buildertek__Description__c}"  />  
                                        </td>
                                        
                                        <td>
                                            <aura:if isTrue="{!row.buildertek__Vendor__c}">
                                                <!--       <ui:outputText value="{!row.buildertek__Vendor__r.Name}" />  --> 
                                                
                                                <ui:outputURL
                                                              value="{!'/one/one.app?#/sObject/'+ row.buildertek__Vendor__c + '/view'}"
                                                              target="_blank" label="{!row.buildertek__Vendor__r.Name}" />  
                                                
                                                <aura:set attribute="else">
                                                    <h1 style = "color:red;">
                                                        
                                                        There is no Vendor assigned to this PO
                                                        
                                                    </h1>
                                                </aura:set>
                                            </aura:if> 
                                            
                                        </td>
                                        
                                        <td>
                                            <aura:if isTrue="{!row.buildertek__Vendor__c}">
                                                <aura:if isTrue="{!row.buildertek__Vendor__r.buildertek__Email_Address__c}">
                                                    <ui:outputText value="{!row.buildertek__Vendor__r.buildertek__Email_Address__c}" /> 
                                                    
                                                    <aura:set attribute="else">
                                                        <h1 style = "color:red;">
                                                            
                                                            There is no Email for this Vendor
                                                            
                                                        </h1>
                                                    </aura:set>
                                                </aura:if>
                                                <aura:set attribute="else">
                                                    <span></span>
                                                </aura:set>
                                            </aura:if>
                                        </td>
                                        
                                        
                                        
                                        <td>
                                            
                                            <lightning:formattedNumber value="{!row.buildertek__PO_Total__c}" currencyCode="USD" style="currency" currencyDisplayAs="code"/>
                                            
                                        </td>
                                        
                                        <td>
                                            
                                            <!--  <span style="cursor: pointer"  onclick="{!c.uploadFile}">
                                                <lightning:icon iconName="utility:upload" size="xx-small" class="my-icon" />
                                            </span>  -->
                                            <div class="slds-file-selector__dropzone">
                                                <input type="file" class="slds-file-selector__input slds-assistive-text" data-index = "{!row.Id}" id="{!row.Id}" onchange="{!c.handleFilesChange2}" aria-labelledby="file-selector-primary-label file-selector-secondary-label"  multiple="true"/>
                                                
                                                
                                                <label class="slds-file-selector__body" for="{!row.Id}" id="file-selector-secondary-label2"> 
                                                    <span class="slds-file-selector__button slds-button slds-button_neutral">
                                                        Upload Files
                                                    </span>
                                                </label>
                                                
                                                <aura:iteration items="{!v.FileNameList}" var="sr" indexVar="fileindex">
                                                    <aura:if isTrue="{!sr.poId == row.Id}">
                                                        <div>
                                                            <span>
                                                                <lightning:pill class="slds-m-around_xx-small slds-text-body_small slds-text-color_error" label="{!sr.FileName}" name="{!fileindex+'_'+row.Id}" onremove="{! c.clear }">
                                                                    <aura:set attribute="media">
                                                                        <lightning:icon iconName="standard:file" size="x-small" alternativeText="icon"/>
                                                                    </aura:set>
                                                                </lightning:pill>
                                                            </span>
                                                        </div>
                                                    </aura:if>
                                                    
                                                </aura:iteration>
                                                
                                                
                                                
                                            </div>
                                        </td>
                                        
                                        
                                        
                                    </tr>
                                </aura:iteration>
                                
                            </tbody>
                            
                        </table>
                    </div>
                </div>
                
                <footer class="slds-modal__footer">
                    <lightning:button variant="Neutral" class="slds-button" label="Close" onclick="{!c.closePOListPopUp}"/>
                    <button class="slds-button slds-button--brand" onclick="{!c.confirmOrderPO}"> Yes</button>
                </footer>
            </div>
            
            <aura:if isTrue="{!v.Spinner2}">
                <div aura:id="spinnerId" class="slds-spinner_container">
                    <div class="slds-spinner--brand  slds-spinner slds-spinner--large slds-is-relative" role="alert">
                        <span class="slds-assistive-text">Loading</span>
                        <div class="slds-spinner__dot-a"></div>
                        <div class="slds-spinner__dot-b"></div>
                        <div class="custom-loading-text">
                            <b>Processing, Please Wait</b>
                        </div>
                    </div>
                </div>
            </aura:if>
            
        </section>
        
        
        
        
        <div class="slds-backdrop slds-backdrop_open"></div>
    </aura:if> 
    
    
    
    
    
</aura:component>