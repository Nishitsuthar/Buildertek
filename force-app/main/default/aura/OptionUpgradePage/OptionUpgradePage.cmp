<!-- This Component Called From OptionUpgrade.cmp -->
<aura:component controller="OptionUpgrade">

    <lightning:workspaceAPI aura:id="workspace"/>
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:attribute name="recordId" type="String" />
    <aura:attribute name="productList" type="Object" />
    <aura:attribute name="isModalOpen" type="boolean" default="false"/>
    <aura:attribute name="nullPricebook" type="boolean" default="false"/>
    <aura:attribute name="pricebookList" type="Object" />
    <aura:attribute name="selectedPricebook" type="String" />
    <aura:attribute name="firstModal" type="boolean" default="true" />

    <aura:attribute name="searchNameFilter" type="String" default="" />
    <aura:handler name="change" value="{!v.searchNameFilter}" action="{!c.doSearch}" />

    <aura:attribute name="searchTypeFilter" type="String" default="" />
    <aura:handler name="change" value="{!v.searchTypeFilter}" action="{!c.doSearch}" />
    
    <aura:attribute name="searchManufacturerFilter" type="String" default="" />
    <aura:handler name="change" value="{!v.searchManufacturerFilter}" action="{!c.doSearch}" />
    
    <aura:attribute name="searchFamilyFilter" type="String" default="" />
    <aura:handler name="change" value="{!v.searchFamilyFilter}" action="{!c.doSearch}" />

    <div style = "position : sticky; top:5.6rem; background : white; z-index : 1">

        <lightning:layout multipleRows="true" class="searchbarList">
            <lightning:layoutItem padding="around-small" size="3">
                <lightning:input autocomplete="off" type="search" placeholder="Search Product Name" variant="label-hidden" value="{!v.searchNameFilter}" />
            </lightning:layoutItem>

            <lightning:layoutItem padding="around-small" size="3">
                <lightning:input autocomplete="off" type="search" placeholder="Search Product Type" variant="label-hidden" value="{!v.searchTypeFilter}" />
            </lightning:layoutItem>
            
            <lightning:layoutItem padding="around-small" size="3">
                <lightning:input autocomplete="off" type="search" placeholder="Search Manufacturer" variant="label-hidden" value="{!v.searchManufacturerFilter}" />
            </lightning:layoutItem>

            <lightning:layoutItem padding="around-small" size="3"> 
                <lightning:input autocomplete="off" type="search" placeholder="Search Product Family" variant="label-hidden" value="{!v.searchFamilyFilter}"  />
            </lightning:layoutItem>
        </lightning:layout>

        <aura:if isTrue="{!v.isModalOpen}">
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <lightning:buttonIcon iconName="utility:close" onclick="{! c.closeModel }" alternativeText="close" variant="bare-inverse" class="slds-modal__close"/>
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Update Price</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">

                        <!-- <aura:if isTrue="{!v.firstModal}"> -->
                            <aura:if isTrue="{!v.nullPricebook}">
                                There Are No PriceBook In This Product
                                <aura:set attribute="else">
    
                                    <table class="slds-table slds-table_bordered slds-table_fixed-layout " role="grid">
                                        <thead>
                                            <tr class="slds-text-title_caps">
                                                <!-- <th style="width: 30px;"> </th> -->
                                                <th> Pricebook Name </th>
                                                <th> Unit Price </th>
                                            </tr>
                                        </thead>
                                        <tbody class = "slds-scrollable">
                                            <aura:iteration items="{!v.pricebookList}" var="pricebook">
                    
                                            <tr>
                                                <!-- <td>
                                                    <ui:inputRadio name="pricebook" change="{!c.selectPriceBook}" text="{!pricebook.Id}" />
                                                </td> -->
                                                <td> 
                                                 
                                                    {!pricebook.Name}
                                                </td>
                                                <td> 
                                                    {!pricebook.UnitPrice}
                                                </td>
                                            </tr>
                    
                                            </aura:iteration>
                                        </tbody>
                                    </table>
    
                                </aura:set>
                            </aura:if>

                            <!-- <aura:set attribute="else" >
                                Second Modal
                            </aura:set>
                        </aura:if> -->
                       
                    </div>
                    <footer class="slds-modal__footer">
                        <lightning:button variant="neutral" label="Cancel" onclick="{!c.closeModel}"/>
                        <lightning:button variant="brand" label="Upgrade" onclick="{!c.onUpgrade}"/>
                        
                        <!-- <aura:if isTrue="{!v.firstModal}" >
                            <lightning:button variant="brand" label="Next" onclick="{!c.onNext}"/>
                            <aura:set attribute="else" >
                                <lightning:button variant="brand" label="Save" onclick="{!c.onSave}"/>
                            </aura:set>
                        </aura:if> -->
                        
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </aura:if>


        <div class="slds-modal__content slds-p-around_xx-small">
            <div class="slds slds-scope">

                <table class="slds-table slds-table_bordered slds-table_fixed-layout " role="grid">
                    <thead>
                        <tr class="slds-text-title_caps">
                            <th> Product Name </th>
                            <th> Product Type </th>
                            <th> Manufacturer </th>
                            <th> Product Family </th>
                            <th> Category </th>
                            <th> </th>
                        </tr>
                    </thead>
                    <tbody class = "slds-scrollable">
                        <aura:iteration items="{!v.productList}" var="Product" indexVar="index">

                        <tr>
                            <td> 
                                <ui:outputURL value="{!'/one/one.app?#/sObject/'+ Product.Id + '/view'}" target="_blank" label="{!Product.Name}" />
                            </td>
                            <td> 
                                <ui:outputURL value="{!'/one/one.app?#/sObject/'+ Product.buildertek__Product_Type__c + '/view'}" target="_blank" label="{!Product.buildertek__Product_Type__r.Name}" />
                            </td>
                            <td>  
                                <ui:outputURL value="{!'/one/one.app?#/sObject/'+ Product.buildertek__Manufacturer__c + '/view'}" target="_blank" label="{!Product.buildertek__Manufacturer__r.Name}" />
                            </td>
                            <td> {!Product.Family} </td>
                            <td> 
                                <ui:outputURL value="{!'/one/one.app?#/sObject/'+ Product.buildertek__Category__c + '/view'}" target="_blank" label="{!Product.buildertek__Category__r.Name}" />
                            </td>
                            <td> 
                                <lightning:button variant="brand" label="Update Record" onclick="{!c.handleClick}" value="{!index}" />    
                            </td>
                        </tr>

                        </aura:iteration>
                    </tbody>
                </table>

            </div>
        </div>

    </div>

</aura:component>